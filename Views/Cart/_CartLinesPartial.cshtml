@model FoodTruck.Web.Models.ViewModels.CartViewModel

@if (Model.Items == null || !Model.Items.Any())
{
    <p class="text-muted">Your cart is currently empty.</p>
}
else
{
    <form asp-controller="Cart" asp-action="Update" method="post">
        @Html.AntiForgeryToken()

        <table class="table table-striped align-middle">
            <thead>
                <tr>
                    <th>Item</th>
                    <th>Notes</th>
                    <th style="width: 120px;">Quantity</th>
                    <th class="text-end" style="width: 120px;">Unit Price</th>
                    <th class="text-end" style="width: 120px;">Line Total</th>
                    <th class="text-end" style="width: 80px;">Remove</th>
                </tr>
            </thead>
            <tbody>
                @for (int i = 0; i < Model.Items.Count; i++)
                {
                    var line = Model.Items[i];

                    <tr>
                        <!-- Keep MenuItemId hidden so we know what line is what -->
                        <input type="hidden" asp-for="Items[@i].MenuItemId" />

                        <td>
                            <strong>@line.Name</strong>
                        </td>

                        <td>
                            <input asp-for="Items[@i].Quantity"
                                   class="form-control form-control-sm"
                                   min="1"
                                   type="number" />
                            <span asp-validation-for="Items[@i].Quantity" class="text-danger small"></span>
                        </td>

                        <td class="text-end">
                            @line.UnitPrice.ToString("C")
                        </td>

                        <td class="text-end">
                            @line.LineTotal.ToString("C")
                        </td>

                        <td class="text-end">
                            <button type="submit"
                                    name="removeIndex"
                                    value="@i"
                                    class="btn btn-sm btn-outline-danger">
                                Ã—
                            </button>
                        </td>
                    </tr>
                }
            </tbody>
            <tfoot>
                <tr>
                    <th colspan="4" class="text-end">Subtotal:</th>
                    <th class="text-end">@Model.Subtotal.ToString("C")</th>
                    <th></th>
                </tr>
            </tfoot>
        </table>

        <div class="text-end">
            <!-- IMPORTANT: this is a BUTTON, not an <a> link -->
            <button type="submit" class="btn btn-primary">
                Update Quantities
            </button>
        </div>
    </form>
}